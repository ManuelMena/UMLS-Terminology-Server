{
  "id": 7756353,
  "lastModified": 1501872250000,
  "lastModifiedBy": "JFW",
  "timestamp": 1488550026000,
  "type": "QUALITY_ASSURANCE",
  "mutuallyExclusive": false,
  "adminConfig": false,
  "queryStyle": "CLUSTER",
  "lastPartitionTime": null,
  "projectId": 37901,
  "workflowBinDefinitions": [
    {
      "id": 7756448,
      "lastModified": 1501871888000,
      "lastModifiedBy": "JFW",
      "timestamp": 1488565611000,
      "name": "nci_merge",
      "description": "Merged SCUI current version NCI atoms",
      "query": "select distinct c.id conceptId \nfrom concepts c, concepts_atoms ca, atoms a\nwhere c.terminology = :terminology\n  and c.id = ca.concepts_id and ca.atoms_id = a.id and a.publishable = true\n  and a.terminology='NCI'\ngroup by c.id having count(distinct a.conceptId)>1",
      "queryType": "SQL",
      "editable": true,
      "enabled": true,
      "required": true,
      "workflowConfigId": 7756353
    },
    {
      "id": 7756450,
      "lastModified": 1501871888000,
      "lastModifiedBy": "JFW",
      "timestamp": 1488565651000,
      "name": "nci_sub_split",
      "description": "Split SCUI current version NCI (or sub-source) atoms",
      "query": "SELECT DISTINCT\n    c.id conceptId1, c1.id conceptId2\nFROM\n    concepts c,\n    concepts_atoms ca,\n    atoms a,\n    concepts c1,\n    concepts_atoms ca1,\n    atoms a1\nWHERE\n    c.terminology = :terminology\n        AND c1.terminology = :terminology\n        AND c.id = ca.concepts_id\n        AND ca.atoms_id = a.id\n        AND c1.id = ca1.concepts_id\n        AND ca1.atoms_id = a1.id\n        AND a.terminology = 'NCI'\n        AND a1.terminology IN (SELECT \n            terminology\n        FROM\n            root_terminologies\n        WHERE\n            family = 'NCI' AND terminology != 'NCI')\n        AND a.conceptId = a1.conceptId\n        AND c.id != c1.id",
      "queryType": "SQL",
      "editable": true,
      "enabled": true,
      "required": true,
      "workflowConfigId": 7756353
    },
    {
      "id": 7797301,
      "lastModified": 1501871888000,
      "lastModifiedBy": "JFW",
      "timestamp": 1488565674000,
      "name": "sct_sepfnpt",
      "description": "SNOMED concept clusters where the FN and PT terms are separated",
      "query": "SELECT DISTINCT\n    c.id conceptId1, c1.id conceptId2\nFROM\n    concepts c,\n    concepts_atoms ca,\n    atoms a,\n    concepts c1,\n    concepts_atoms ca1,\n    atoms a1\nWHERE\n    c.terminology = :terminology\n        AND c1.terminology = :terminology\n        AND a.terminology = 'SNOMEDCT_US'\n        AND a1.terminology = 'SNOMEDCT_US'\n        AND c.id = ca.concepts_id\n        AND ca.atoms_id = a.id\n        AND c1.id = ca1.concepts_id\n        AND ca1.atoms_id = a1.id\n        AND a.termType = 'FN'\n        AND a1.termType = 'PT'\n        AND a.conceptId = a1.conceptId\n        AND c.id != c1.id",
      "queryType": "SQL",
      "editable": true,
      "enabled": true,
      "required": true,
      "workflowConfigId": 7756353
    },
    {
      "id": 7797302,
      "lastModified": 1501871888000,
      "lastModifiedBy": "JFW",
      "timestamp": 1488565694000,
      "name": "cdsty_coc",
      "description": "Find concepts with Clinical Drug STY and any other STY",
      "query": "SELECT DISTINCT\n    c.id conceptId\nFROM\n    concepts c,\n    concepts_semantic_type_components cs\nWHERE\n    c.terminology = :terminology\n        AND c.id = cs.concepts_id\n        AND cs.concepts_id IN (SELECT \n            cs.concepts_id\n        FROM\n            concepts c,\n            concepts_semantic_type_components cs,\n            semantic_type_components s\n        WHERE\n            c.terminology = :terminology\n                AND c.id = cs.concepts_id\n                AND cs.semanticTypes_id = s.id\n                AND s.semanticType = 'Clinical Drug')\nGROUP BY cs.concepts_id\nHAVING COUNT(cs.concepts_id) > 1",
      "queryType": "SQL",
      "editable": true,
      "enabled": true,
      "required": true,
      "workflowConfigId": 7756353
    },
    {
      "id": 7797303,
      "lastModified": 1501871888000,
      "lastModifiedBy": "JFW",
      "timestamp": 1488565714000,
      "name": "multsty",
      "description": "concepts with more than 3 STYs",
      "query": "SELECT DISTINCT\n    cs.concepts_id conceptId\nFROM\n\tconcepts c,\n    concepts_semantic_type_components cs,\n    semantic_type_components s\nWHERE\n\tc.terminology = :terminology\n\tAND c.id = cs.concepts_id\n    AND cs.semanticTypes_id = s.id\nGROUP BY c.id\nHAVING COUNT(c.id) > 3",
      "queryType": "SQL",
      "editable": true,
      "enabled": true,
      "required": true,
      "workflowConfigId": 7756353
    },
    {
      "id": 7797304,
      "lastModified": 1501871888000,
      "lastModifiedBy": "JFW",
      "timestamp": 1488565738000,
      "name": "styisa",
      "description": "One STY is an ancestor of another in the STY isa hierarchy",
      "query": "select t1.conceptId from \n(select c.id conceptId, st.id styId, st.treeNumber from concepts c, concepts_semantic_type_components cstc, (select stc.id, st.treeNumber from semantic_type_components stc join semantic_types st on (stc.semanticType = st.expandedForm)) st\nWHERE c.terminology = :terminology\nAND c.id = cstc.concepts_id\nAND cstc.semanticTypes_id = st.id) t1\nJOIN \n(select c.id conceptId, st.id styId, st.treeNumber from concepts c, concepts_semantic_type_components cstc, (select stc.id, st.treeNumber from semantic_type_components stc join semantic_types st on (stc.semanticType = st.expandedForm)) st\nWHERE c.terminology = :terminology\nAND c.id = cstc.concepts_id\nAND cstc.semanticTypes_id = st.id) t2\non  (t1.conceptId = t2.conceptId and t1.styId != t2.styId and t1.treeNumber != t2.treeNumber)\nWHERE t2.treeNumber like concat(t1.treeNumber, '.%')",
      "queryType": "SQL",
      "editable": true,
      "enabled": true,
      "required": true,
      "workflowConfigId": 7756353
    },
    {
      "id": 7797305,
      "lastModified": 1501871888000,
      "lastModifiedBy": "JFW",
      "timestamp": 1488565761000,
      "name": "sfo_lfo",
      "description": "Short form in one concept, long form in another",
      "query": "SELECT \n    c1.id conceptId1, c2.id conceptId2\nFROM\n    concepts c1,\n    concepts_atoms ca1,\n    atoms a1,\n    concepts c2,\n    concepts_atoms ca2,\n    atoms a2,\n    (SELECT \n        ar.from_id, ar.to_id\n    FROM\n        atom_relationships ar\n    WHERE\n        publishable = TRUE\n            AND relationshipType = 'SY'\n            AND (additionalRelationshipType = 'expanded_form_of'\n            OR additionalRelationshipType LIKE 'mth_%_form_of')) sfoLfoRels\nWHERE\n    c1.terminology = 'NCIMTH'\n        AND c2.terminology = 'NCIMTH'\n        AND c1.id = ca1.concepts_id\n        AND ca1.atoms_id = a1.id\n        AND c2.id = ca2.concepts_id\n        AND ca2.atoms_id = a2.id\n        AND a1.id = sfoLfoRels.from_id\n        AND a2.id = sfoLfoRels.to_id\n        AND c1.id != c2.id",
      "queryType": "SQL",
      "editable": true,
      "enabled": true,
      "required": true,
      "workflowConfigId": 7756353
    },
    {
      "id": 7797306,
      "lastModified": 1501871888000,
      "lastModifiedBy": "JFW",
      "timestamp": 1488809466000,
      "name": "deleted_cui",
      "description": "CUIs that are going away - will need bequeathal rel.  To remove cases from this bin, add following code to remove ids from tempTable:\n    AND NOT c.id IN (SELECT id from tempTable)",
      "query": "SELECT DISTINCT\n    c.id conceptId\nFROM\n    concepts c,\n    concepts_atoms ca,\n    atoms a\nWHERE\n    c.terminology = :terminology\n        AND c.id = ca.concepts_id\n        AND ca.atoms_id = a.id\n        AND a.publishable = TRUE\n        AND NOT c.id IN (SELECT DISTINCT\n            c.id conceptId\n        FROM\n            concepts c,\n            concepts_atoms ca,\n            atoms a\n        WHERE\n            c.terminology = :terminology\n                AND c.id = ca.concepts_id\n                AND ca.atoms_id = a.id\n                AND a.publishable = FALSE)",
      "queryType": "SQL",
      "editable": true,
      "enabled": true,
      "required": true,
      "workflowConfigId": 7756353
    },
    {
      "id": 7797307,
      "lastModified": 1501871888000,
      "lastModifiedBy": "JFW",
      "timestamp": 1488565891000,
      "name": "rxnorm_merge",
      "description": "RXCUI Merges",
      "query": "select distinct c.id conceptId \nfrom concepts c, concepts_atoms ca, atoms a\nwhere c.terminology = :terminology\n  and c.id = ca.concepts_id and ca.atoms_id = a.id and a.publishable = true\n  and a.terminology='RXNORM'\ngroup by c.id having count(distinct a.conceptId)>1",
      "queryType": "SQL",
      "editable": true,
      "enabled": true,
      "required": false,
      "workflowConfigId": 7756353
    },
    {
      "id": 7797308,
      "lastModified": 1501871888000,
      "lastModifiedBy": "JFW",
      "timestamp": 1488566145000,
      "name": "rxnorm_split",
      "description": "RXCUI splits",
      "query": "select distinct c.id conceptId \nfrom concepts c, concepts_atoms ca, atoms a\nwhere c.terminology = :terminology\n  and c.id = ca.concepts_id and ca.atoms_id = a.id and a.publishable = true\n  and a.terminology='RXNORM'\ngroup by a.conceptId having count(distinct c.id)>1",
      "queryType": "SQL",
      "editable": true,
      "enabled": true,
      "required": false,
      "workflowConfigId": 7756353
    },
    {
      "id": 7797309,
      "lastModified": 1501871888000,
      "lastModifiedBy": "JFW",
      "timestamp": 1488566235000,
      "name": "ambig_no_pn",
      "description": "Ambiguous concepts where at least one has no MTH/PN nor NCIMTH/PN (sepstring)",
      "query": "SELECT \n    conceptId1, conceptId2\nFROM\n    ambig_concepts\nWHERE\n    NOT ambig_concepts.conceptId1 IN (SELECT \n            ca.concepts_id\n        FROM\n            concepts_atoms ca,\n            atoms a\n        WHERE\n            ca.atoms_id = a.id\n                AND a.terminology IN ('NCIMTH' , 'MTH')\n                AND a.termType = 'PN')\n        AND NOT ambig_concepts.conceptId2 IN (SELECT \n            ca.concepts_id\n        FROM\n            concepts_atoms ca,\n            atoms a\n        WHERE\n            ca.atoms_id = a.id\n                AND a.terminology IN ('NCIMTH' , 'MTH')\n                AND a.termType = 'PN')",
      "queryType": "SQL",
      "editable": true,
      "enabled": true,
      "required": false,
      "workflowConfigId": 7756353
    },
    {
      "id": 7797310,
      "lastModified": 1501871888000,
      "lastModifiedBy": "JFW",
      "timestamp": 1488566259000,
      "name": "ambig_no_rel",
      "description": "Ambiguous concepts that lack an approved REL",
      "query": "SELECT \n    conceptId1, conceptId2\nFROM\n    ambig_concepts\nWHERE\n    NOT (conceptId1 , conceptId2) IN (SELECT \n            cr.from_id, cr.to_id\n        FROM\n            concept_Relationships cr\n        WHERE\n            cr.publishable = TRUE\n            AND cr.workflowStatus in ('READY_FOR_PUBLICATION','PUBLISHED'))",
      "queryType": "SQL",
      "editable": true,
      "enabled": true,
      "required": false,
      "workflowConfigId": 7756353
    },
    {
      "id": 7797311,
      "lastModified": 1501871888000,
      "lastModifiedBy": "JFW",
      "timestamp": 1488566281000,
      "name": "pn_pn_ambig",
      "description": "Identical (same SUI) PN's in multiple concepts",
      "query": "SELECT \n    c1.id conceptId1, c2.id conceptId2\nFROM\n    concepts c1,\n    concepts c2,\n    concepts_atoms ca1,\n    concepts_atoms ca2,\n    (SELECT \n        a1.id atomId1, a2.id atomId2\n    FROM\n        atoms a1, atoms a2\n    WHERE\n        a1.termType = 'PN'\n            AND a2.termType = 'PN'\n            AND a1.stringClassId = a2.stringClassId\n            AND a1.id != a2.id) identicalPNAtoms\nWHERE\n    c1.terminology = :terminology\n        AND c2.terminology = :terminology\n        AND c1.id = ca1.concepts_id\n        AND c2.id = ca2.concepts_id\n        AND ca1.atoms_id = identicalPNAtoms.atomId1\n        AND ca2.atoms_id = identicalPNAtoms.atomId2\n        AND c1.id != c2.id",
      "queryType": "SQL",
      "editable": true,
      "enabled": true,
      "required": false,
      "workflowConfigId": 7756353
    },
    {
      "id": 7797312,
      "lastModified": 1501871888000,
      "lastModifiedBy": "JFW",
      "timestamp": 1488566303000,
      "name": "multiple_pn",
      "description": "Concepts with multiple MTH/PN atoms",
      "query": "SELECT DISTINCT\n    c.id conceptId\nFROM\n    concepts c,\n    atoms a,\n    concepts_atoms ca\nWHERE\n    c.terminology = :terminology\n        AND c.id = ca.concepts_id\n        AND ca.atoms_id = a.id\n        AND a.terminology in ('MTH', 'NCIMTH')\n        AND a.termType = 'PN'\nGROUP BY c.id\nHAVING COUNT(c.id) > 1",
      "queryType": "SQL",
      "editable": true,
      "enabled": true,
      "required": false,
      "workflowConfigId": 7756353
    },
    {
      "id": 7797313,
      "lastModified": 1501871888000,
      "lastModifiedBy": "JFW",
      "timestamp": 1488809122000,
      "name": "pn_no_ambig",
      "description": "Concept has MTH/PN atom but no ambiguous string",
      "query": "select distinct c.id conceptId \nfrom concepts c, concepts_atoms ca, atoms a\nwhere c.terminology = :terminology\n  and c.id = ca.concepts_id and ca.atoms_id = a.id and a.publishable = true\n  and a.terminology in ('NCIMTH','MTH')\n  and a.termType = 'PN'\n  and not c.id in (select conceptId1 from ambig_concepts)",
      "queryType": "SQL",
      "editable": true,
      "enabled": true,
      "required": false,
      "workflowConfigId": 7756353
    },
    {
      "id": 7797314,
      "lastModified": 1501871888000,
      "lastModifiedBy": "JFW",
      "timestamp": 1488809252000,
      "name": "pn_orphan",
      "description": "MTH/PNs on their own",
      "query": "SELECT \n    c.id conceptId\nFROM\n    concepts c,\n    concepts_atoms ca\nWHERE\n    c.terminology = :terminology\n        AND c.id = ca.concepts_id\n        AND ca.concepts_id IN (SELECT \n            ca.concepts_id\n        FROM\n            concepts_atoms ca,\n            atoms a\n        WHERE\n            ca.atoms_id = a.id\n                AND a.terminology IN ('MTH' , 'NCIMTH')\n                AND a.termType = 'PN'\n                AND a.publishable = true)\nGROUP BY ca.concepts_id\nHAVING COUNT(DISTINCT ca.atoms_id) = 1",
      "queryType": "SQL",
      "editable": true,
      "enabled": true,
      "required": false,
      "workflowConfigId": 7756353
    },
    {
      "id": 7797315,
      "lastModified": 1502305220000,
      "lastModifiedBy": "JFW",
      "timestamp": 1488809275000,
      "name": "nosty",
      "description": "No STY",
      "query": "SELECT DISTINCT\n    c.id conceptId\nFROM\n    concepts c\n        LEFT JOIN\n    concepts_semantic_type_components cs ON (c.id = cs.concepts_id)\nWHERE\n\tc.terminology= :terminology\n    AND c.publishable=true\n    AND cs.semanticTypes_id IS NULL",
      "queryType": "SQL",
      "editable": true,
      "enabled": true,
      "required": false,
      "workflowConfigId": 7756353
    },
    {
      "id": 7797316,
      "lastModified": 1501871888000,
      "lastModifiedBy": "JFW",
      "timestamp": 1488809300000,
      "name": "missing_sty",
      "description": "Reviewed concepts without releasable Semantic Types",
      "query": "SELECT DISTINCT\n    c.id conceptId\nFROM\n    concepts c\nWHERE\n    c.terminology = :terminology\n        AND c.publishable = TRUE\n        AND c.workflowStatus IN ('READY_FOR_PUBLICATION' , 'PUBLISHED')\n        AND NOT c.id IN (SELECT \n            c.id\n        FROM\n            concepts c,\n            concepts_semantic_type_components cs,\n            semantic_type_components s\n        WHERE\n            c.terminology = :terminology\n                AND c.id = cs.concepts_id\n                AND cs.semanticTypes_id = s.id\n                AND s.publishable = TRUE)",
      "queryType": "SQL",
      "editable": true,
      "enabled": true,
      "required": false,
      "workflowConfigId": 7756353
    },
    {
      "id": 7797317,
      "lastModified": 1501871888000,
      "lastModifiedBy": "JFW",
      "timestamp": 1488809343000,
      "name": "cbo_chem",
      "description": "Current version CBO concepts with CHEM STYs",
      "query": "SELECT DISTINCT\n    c.id conceptId\nFROM\n    concepts c,\n    concepts_semantic_type_components cs,\n    semantic_type_components s,\n    terminologies t\nWHERE\n    c.terminology = 'CBO'\n        AND c.terminology = t.terminology\n        AND c.version = t.version\n        AND t.current = TRUE\n        AND c.id = cs.concepts_id\n        AND cs.semanticTypes_id = s.id\n        AND s.semanticType IN ((SELECT DISTINCT\n            semanticTypeCategoryMap_KEY sty\n        FROM\n            projects a,\n            ProjectJpa_semanticTypeCategoryMap b\n        WHERE\n            a.id = b.ProjectJpa_id\n                AND semanticTypeCategoryMap = 'chem'\n                AND a.terminology = :terminology))",
      "queryType": "SQL",
      "editable": true,
      "enabled": true,
      "required": false,
      "workflowConfigId": 7756353
    },
    {
      "id": 7797318,
      "lastModified": 1501871888000,
      "lastModifiedBy": "JFW",
      "timestamp": 1488809365000,
      "name": "go_chem",
      "description": "Current version GO concepts with CHEM STYs",
      "query": "SELECT DISTINCT\n    c.id conceptId\nFROM\n    concepts c,\n    concepts_semantic_type_components cs,\n    semantic_type_components s,\n    terminologies t\nWHERE\n    c.terminology = 'GO'\n        AND c.terminology = t.terminology\n        AND c.version = t.version\n        AND t.current = TRUE\n        AND c.id = cs.concepts_id\n        AND cs.semanticTypes_id = s.id\n        AND s.semanticType IN ((SELECT DISTINCT\n            semanticTypeCategoryMap_KEY sty\n        FROM\n            projects a,\n            ProjectJpa_semanticTypeCategoryMap b\n        WHERE\n            a.id = b.ProjectJpa_id\n                AND semanticTypeCategoryMap = 'chem'\n                AND a.terminology = :terminology))",
      "queryType": "SQL",
      "editable": true,
      "enabled": true,
      "required": false,
      "workflowConfigId": 7756353
    },
    {
      "id": 7797319,
      "lastModified": 1501871888000,
      "lastModifiedBy": "JFW",
      "timestamp": 1488809386000,
      "name": "mdr_chem",
      "description": "Current version MDR concepts with CHEM STYs",
      "query": "SELECT DISTINCT\n    c.id conceptId\nFROM\n    concepts c,\n    concepts_semantic_type_components cs,\n    semantic_type_components s,\n    terminologies t\nWHERE\n    c.terminology = 'MDR'\n        AND c.terminology = t.terminology\n        AND c.version = t.version\n        AND t.current = TRUE\n        AND c.id = cs.concepts_id\n        AND cs.semanticTypes_id = s.id\n        AND s.semanticType IN ((SELECT DISTINCT\n            semanticTypeCategoryMap_KEY sty\n        FROM\n            projects a,\n            ProjectJpa_semanticTypeCategoryMap b\n        WHERE\n            a.id = b.ProjectJpa_id\n                AND semanticTypeCategoryMap = 'chem'\n                AND a.terminology = :terminology))",
      "queryType": "SQL",
      "editable": true,
      "enabled": true,
      "required": false,
      "workflowConfigId": 7756353
    },
    {
      "id": 7797320,
      "lastModified": 1502230911000,
      "lastModifiedBy": "JFW",
      "timestamp": 1488809415000,
      "name": "true_orphan",
      "description": "Concepts with no releasable relationships to any other concept",
      "query": "SELECT c.id conceptId\nFROM concepts c\nWHERE c.terminology = :terminology\nAND c.publishable=TRUE\nAND NOT EXISTS\n    (SELECT * FROM deep_concept_relationships dcr\n     WHERE c.id = dcr.concepts_id)",
      "queryType": "SQL",
      "editable": true,
      "enabled": true,
      "required": false,
      "workflowConfigId": 7756353
    },
    {
      "id": 7797321,
      "lastModified": 1501871888000,
      "lastModifiedBy": "JFW",
      "timestamp": 1488809543000,
      "name": "mxsuppr",
      "description": "Concepts with identical LUI atoms that have mixed suppressibility",
      "query": "SELECT DISTINCT\n    c.id conceptId\nFROM\n    concepts c,\n    concepts_atoms ca1,\n    concepts_atoms ca2,\n    (SELECT \n        a1.id atomId1, a2.id atomId2\n    FROM\n        atoms a1, atoms a2\n    WHERE\n        a1.lexicalClassId = a2.lexicalClassId\n            AND a1.id != a2.id\n            AND a1.publishable = TRUE\n            AND a2.publishable = TRUE\n            AND a1.suppressible != a2.suppressible) mixedSuppresLuiAtoms\nWHERE\n    c.terminology = :terminology\n        AND c.id = ca1.concepts_id\n        AND ca1.atoms_id = mixedSuppresLuiAtoms.atomId1\n        AND ca2.atoms_id = mixedSuppresLuiAtoms.atomId2\n        AND ca1.concepts_id = ca2.concepts_id",
      "queryType": "SQL",
      "editable": true,
      "enabled": true,
      "required": false,
      "workflowConfigId": 7756353
    }
  ]
}