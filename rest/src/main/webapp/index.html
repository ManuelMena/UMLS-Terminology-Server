<html ng-app="tsApp">
<head>
<meta http-equiv="Content-Language" content="en" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>UMLS Terminology Server Demo</title>
<style type="text/css" media="all"></style>
<!-- Favicon -->
<link rel="icon" type="image/png" href="images/favicon.png" />

<!-- CSS  -->
<link rel="stylesheet"
	href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
<link href="ui/css/tsMobile.css" rel="stylesheet">

<!-- Angular core  -->
<script type="text/javascript"
	src="./ui/components/angular/angular.min.js"></script>

<!-- Angular/Boostrap UI Components -->
<script type="text/javascript"
	src="ui/components/angular-bootstrap/ui-bootstrap.js"></script>
<script type="text/javascript"
	src="ui/components/angular-bootstrap/ui-bootstrap-tpls-0.13.0.min.js"></script>

<!-- Terminology server Angular application -->
<script src="ui/js/app.js"></script>
</head>
<body ng-controller="tsIndexCtrl">
	<!--  Javascript detection -->
	<noscript>
		<style type="text/css">
.container-fluid {
	display: none;
}
</style>
		<div class="alert alert-danger">You must have Javascript enabled
			to use the Terminology Server Demo</div>
	</noscript>


	<!--  header -->
	<nav id="navBar"
		style="background: #00008A url('images/background.jpg');"
		class="navbar navbar-default navbar-fixed-top" role="navigation">
		<!-- Brand and toggle get grouped for better mobile display -->
		<div class="container-fluid">
			<div class="navbar-header">
				<table>
					<tr>
						<td><a href="http://www.westcoastinformatics.com"> <img
								class="hidden-xs" height="72px"
								style="background-color: white; padding: 5px; margin: 5px; border-radius: 5px;"
								src="images/logo65x72.jpg"> <img class="visible-xs"
								height="40px"
								style="background-color: white; padding: 3px; margin: 3px; border-radius: 3px;"
								src="images/logo36x40.jpg">
						</a></td>
						<td style="vertical-align: middle"><b style="color: white;">
								UMLS Terminology Server Demo and <a href="swagger.html"
								style="color: white; text-decoration: underline" target="_blank">API
									Documentation</a>
						</b></td>
					</tr>
				</table>
			</div>
		</div>
	</nav>

	<div class="container-fluid">
		<!-- Blank for header -->
		<div class="hidden-xs" style="height: 94px;">Makes room for
			content</div>
		<div class="visible-xs" style="height: 60px;">Makes room for
			content</div>

		<div class="row">
			<div class="col-md-1 col-xs-0">
				<!-- blank column -->
			</div>

			<!-- Content -->

			<div class="col-md-10 col-xs-12">
				<!-- Error Messages -->
				<div id="errorMsg" class="border-error alert-error"
					ng-show="error.length > 0">
					<h4 class="alert alert-danger alert-error">
						{{error}}
						<div style="display: inline; float: right; width: 3%;">
							<i class="glyphicon glyphicon-remove" ng-click="clearError()"></i>
						</div>
					</h4>
				</div>
				<!-- Done error messages -->

				<!-- Login form -->
				<div ng-show="authToken == null">
					<div>
						<div>
							<strong>Enter User and Password</strong><br>
							<form>
								<input class="loginField" id="userField" ng-model="userName"
									type="text" placeholder="Username" /><br> <input
									class="loginField" id="passwordField" type="password"
									placeholder="Password" ng-model="password" /><br>
								<button class="loginField" id="userLoginButton" type="submit"
									ng-click="login(userName, password)">Login</button>
								<p>
									<br /> <a
										href="https://uts.nlm.nih.gov/license.html#emailTemporaryPassword">Forgot
										Password?</a> <br /> <br />
								</p>
								<p class="introText">This demonstration app is loaded with
									data from these terminologies.</p>
								<ul>
									<li>UMLS, 2014AB</li>
									<li>MSH, 2015_2014_09_08</li>
									<li>SNOMEDCT_US, 2014_09_01</li>
								</ul>
								<p class="introText">The mini version of the UMLS contains
									about 2,000 concepts. Due to the use of IP restricted content, we
									require users to authenticate with an NLM UTS account to ensure
									they have agreed to the UMLS License. We are a UMLS authorized
									content distributor.</p>
								<p class="introText">
									To obtain a UTS account, visit <a href="http://uts.nlm.nih.gov">http://uts.nlm.nih.gov</a>
								</p>
								<p class="introText">
									Disclaimer: this is not an official <a
										href="http://www.ihtsdo.org">NLM</a> site.
								</p>
								<p class="introText">
									For complete documentation, see the <a
										href="http://wiki.terminology.tools/confluence/display/UTS/UMLS+Terminology+Server+Home">UMLS 
										Terminology Server wiki</a>.
								</p>
								<p class="introText">
									For support or questions, email:<a
										href="mailto:info@westcoastinformatics.com">info@westcoastinformatics.com</a>
							</form>
						</div>
					</div>
				</div>
				<!-- Done login form -->


				<!-- Content displayed after log in -->
				<div ng-show="authToken != null">


					<tabset> <tab heading="Concepts"> <!-- Search field is all columns -->
					<div>
						<table class="table">
							<tr>
								<td width="15%;">Terminology</td>
								<td width="85%;"><select ng-model="terminology"
									ng-change="setTerminology(terminology)"
									ng-options="terminology as terminology.terminology for terminology in getAvailableTerminologies() | sortBy:'terminology.terminology'"></select></td>
							<tr>
								<td>Query</td>
								<td><form width="100%">

										<input type="text" ng-model="conceptQuery"
											placeholder="Enter search terms"
											typeahead="suggestion for suggestion in autocomplete(conceptQuery)"
											typeahead-loading="loadingSuggestions"
											typeahead-focus-first="false"
											typeahead-on-select="findConcepts(conceptQuery)"
											typeahead-editable="true">

										<button class="btn btn-small btn-primary" type="submit"
											ng-click="findConcepts(conceptQuery)">Search</button>

									</form></td>
							</tr>
						</table>
					</div>
					<!-- End search field --> <!-- Search Results -->
					<div class="row">

						<!-- search results field is 3 columns -->
						<div class="col-md-4 col-xs-12">

							<div class="alert alert-success"
								ng-show="searchResults.length > 0">{{searchResults.length}}
								Results (Click a row for details)</div>
							<div class="alert alert-danger"
								ng-show="searchResults && searchResults.length == 0">Search
								returned no results.</div>

							<pagination max-size="5" boundary-links="true"
								class="pagination-sm" previous-text="&lsaquo;"
								next-text="&rsaquo;" first-text="&laquo;" last-text="&raquo;"
								ng-show="searchResults.length > pageSize"
								total-items="searchResults.length" ng-model="searchResultsPage"
								ng-change="pagedSearchResults = getPagedArray(searchResults, searchResultsPage, false, null)"></pagination>

							<table class="table table-hover"
								ng-show="searchResults.length > 0">

								<tbody>
									<tr ng-repeat="searchResult in pagedSearchResults"
										ng-click="getComponent(terminology.terminology, searchResult.terminologyId)">
										<td>{{searchResult.terminologyId}}</td>
										<td style="word-wrap: break-word;">{{searchResult.value}}</td>
									</tr>
								</tbody>
							</table>
						</div>

						<div class="col-md-8 col-xs-12" ng-show="componentError != null">
							<div class="alert alert-warning">{{componentError}}</div>
							<button class="btn btn-xs btn-primary"
								ng-click="getPreviousConcept()"
								tooltip="{{getPreviousConceptStr()}}">Back</button>


							<br> {{$scope.conceptHistoryIndex}}<br>
							{{$scope.conceptHistory}}
						</div>

						<!-- Component display is 4 -->
						<div class="col-md-8 col-xs-12" ng-show="component != null">
							<div class="alert alert-info">

								<a class="glyphicon glyphicon-step-backward"
									ng-click="getPreviousConcept()"
									ng-show="conceptHistoryIndex > 0"
									tooltip="{{getPreviousConceptStr()}}"></a> <span
									ng-show="component.terminology != terminology.terminology">{{component.terminology}}</span>
								{{getOrganizingClassType(component.terminology)}} Report <a
									class="glyphicon glyphicon-step-forward"
									ng-click="getNextConcept()"
									ng-show="conceptHistory.length > conceptHistoryIndex + 1 && conceptHistory.length > 0"
									tooltip="{{getNextConceptStr()}}"></a>

							</div>
							<h3>{{component.terminologyId}} {{component.name}}</h3>

							<button ng-show="hasBooleanFieldTrue(component, 'suppressible')"
								ng-click="toggleSuppressible()" class="btn btn-xs btn-primary">
								<span ng-show="showSuppressible == true">Hide
									Suppressible</span> <span ng-show="showSuppressible != true">Show
									Suppressible</span>
							</button>
							<button ng-show="hasBooleanFieldTrue(component, 'obsolete')"
								ng-click="toggleObsolete()" class="btn btn-xs btn-primary">
								<span ng-show="showObsolete == true">Hide Obsolete</span> <span
									ng-show="showObsolete != true">Show Obsolete</span>
							</button>
<!-- no use case for removing atom info 
							<button ng-show="hasBooleanFieldTrue(component, 'atomElement')"
								ng-click="toggleAtomElement()" class="btn btn-xs btn-primary">
								<span ng-show="showAtomElement == true">Hide Atom
									Elements</span> <span ng-show="showAtomElement != true">Show
									Atom Elements</span>
							</button>
 -->
							<!--  Semantic types -->
							<div ng-show="component.semanticType.length > 0">
								<h4>
									Semantic Types (<span
										ng-show="component.semanticType.length != pagedSemanticTypes.totalCt">{{pagedSemanticTypes.totalCt}}
										shown of </span>{{component.semanticType.length}})
								</h4>
								


								<pagination max-size="5" boundary-links="true"
									class="pagination-sm" previous-text="&lsaquo;"
									next-text="&rsaquo;" first-text="&laquo;" last-text="&raquo;"
									ng-show="pagedSemanticTypes.totalCt > pageSize"
									total-items="pagedSemanticTypes.totalCt"
									ng-model="semanticTypesPage"
									ng-change="getPagedSemanticTypes(semanticTypesPage)"></pagination>

								<ul>
									<li class="cr-list" ng-repeat="item in pagedSemanticTypes"
										ng-show="showItem(item)"><span
										class="label label-warning"
										ng-show="item.suppressible == true" tooltip="Suppressible">S</span>
										<span class="label label-default"
										ng-show="item.obsolete == true" tooltip="Obsolete">O</span>
										{{item.semanticType}}</li>
								</ul>

							</div>

							<!--  Definitions -->
							<div ng-show="component.definition.length > 0">
								<h4>
									Definitions (<span
										ng-show="component.definition.length != pagedDefinitions.totalCt">{{pagedDefinitions.totalCt}}
										shown of </span>{{component.definition.length}})
								</h4>
								


								<pagination max-size="5" boundary-links="true"
									class="pagination-sm" previous-text="&lsaquo;"
									next-text="&rsaquo;" first-text="&laquo;" last-text="&raquo;"
									ng-show="pagedDefinitions.totalCt > pageSize"
									total-items="pagedDefinitions.totalCt"
									ng-model="definitionsPage"
									ng-change="getPagedDefinitions(definitionsPage)"></pagination>

								<ul>
									<li class="cr-list" ng-repeat="item in pagedDefinitions"
										ng-show="showItem(item)">
										<span class="label label-info" ng-show="item.atomElement == true" tooltip="{{item.atomElementStr}}">i</span><span
										class="label label-warning"
										ng-show="item.suppressible == true" tooltip="Suppressible">S</span>
										<span class="label label-default"
										ng-show="item.obsolete == true" tooltip="Obsolete">O</span>
										{{item.value}}</li>
								</ul>
								
							    

							</div>

							<!-- Atoms -->
							<div ng-show="component.atom.length > 0">
								<h4>
									Atoms (<span
										ng-show="component.atom.length != pagedAtoms.totalCt">{{pagedAtoms.totalCt}}
										shown of </span>{{component.atom.length}})
								</h4>

								<pagination max-size="5" boundary-links="true"
									class="pagination-sm" previous-text="&lsaquo;"
									next-text="&rsaquo;" first-text="&laquo;" last-text="&raquo;"
									ng-show="component.atom.length > pageSize"
									total-items="pagedAtoms.totalCt" ng-model="atomsPage"
									ng-change="getPagedAtoms(atomsPage)"></pagination>

								<ul>
									<li class="cr-list" ng-repeat="item in pagedAtoms"
										ng-show="showItem(item)"><span
										class="label label-warning"
										ng-show="item.suppressible == true" tooltip="Suppressible">S</span>
										<span class="label label-default"
										ng-show="item.obsolete == true" tooltip="Obsolete">O</span>

										<!--  Format:  name [terminology/termType] codeId componentId descriptorId conceptTerminologyIds
											  NOTE: codeId, componentId, descriptorId automatically shown if of differing terminology, 
											  see each type below for additional rules
										 --> {{item.name}} <!--  Terminology and term type --> [ <!--  Do not show terminology if same as component terminology -->
										<span ng-show="item.terminology != component.terminology">{{item.terminology}}
											/</span> {{item.termType}} ] <!--  For code id, do not show if NOCODE, or if identical to component, concept, or descriptor id -->
										<span
										ng-show="item.codeId != component.terminologyId && item.codeId != item.conceptId && item.codeId != item.descriptorId"
										tooltip="{{item.terminology}} code"> <a
											ng-show="item.codeId != 'NOCODE'"
											ng-click="getCode(item.terminology, item.codeId)">{{item.codeId}}</a><span
											ng-show="item.codeId==='NOCODE'">NOCODE</span></span> <!-- For concept id, do not show if identical to component id -->
										<span
										ng-show="item.terminology != component.terminology || item.conceptId != component.terminologyId"
										tooltip="{{item.terminology}} concept"> <a
											ng-click="getConcept(item.terminology, item.conceptId)">{{item.conceptId}}</a></span>

										<!-- For descriptor id, do not show if identical to component id -->
										<span
										ng-show="item.terminology != component.terminology || item.descriptorId != component.terminologyId"
										tooltip="{{item.terminology}} descriptor"> <a
											ng-click="getDescriptor(item.terminology, item.descriptorId)">{{item.descriptorId}}</a></span>

										<!-- Show any referenced components in the concept terminology id list -->
										<span ng-repeat="(key, value) in item.conceptTerminologyIds">
											<a
											ng-show="key != component.terminology || value != component.terminologyId"
											tooltip="{{key}} concept" ng-click="getComponent(key, value)">{{value}}</a>
									</span></li>
								</ul>
							</div>

							<!--  Attributes -->
							<div ng-show="component.attribute.length > 0">
								<h4>
									Attributes (<span
										ng-show="component.atom.length != pagedAttributes.totalCt">{{pagedAttributes.totalCt}}
										shown of </span>{{component.attribute.length}})
								</h4>
								<pagination max-size="5" boundary-links="true"
									class="pagination-sm" previous-text="&lsaquo;"
									next-text="&rsaquo;" first-text="&laquo;" last-text="&raquo;"
									ng-show="pagedAttributes.totalCt > pageSize"
									total-items="pagedAttributes.totalCt" ng-model="attributesPage"
									ng-change="getPagedAttributes(attributesPage)"></pagination>

								<ul>
									<li class="cr-list" ng-repeat="item in pagedAttributes"
										ng-show="showItem(item)"><span
										class="label label-warning"
										ng-show="item.suppressible == true" tooltip="Suppressible">S</span>
										<span class="label label-default"
										ng-show="item.obsolete == true" tooltip="Obsolete">O</span>
										{{item.name}} = {{item.value}}
								</ul>
							</div>

							<!-- Relationships -->
							<div ng-show="component.relationship.length> 0">
								<h4>
									Relationships (<span
										ng-show="component.relationship.length != pagedRelationships.totalCt">{{pagedRelationships.totalCt}}
										shown of </span>{{component.relationship.length}})
								</h4>

								<pagination max-size="5" boundary-links="true"
									class="pagination-sm" previous-text="&lsaquo;"
									next-text="&rsaquo;" first-text="&laquo;" last-text="&raquo;"
									ng-show="pagedRelationships.totalCt > pageSize"
									total-items="pagedRelationships.totalCt"
									ng-model="relationshipsPage"
									ng-change="getPagedRelationships(relationshipsPage)"></pagination>
								<ul>
									<li class="cr-list" ng-repeat="item in pagedRelationships"
										ng-show="showItem(item)"><span
										class="label label-warning"
										ng-show="item.suppressible == true" tooltip="Suppressible">S</span>
										<span class="label label-default"
										ng-show="item.obsolete == true" tooltip="Obsolete">O</span>
										{{item.relationshipType}} {{item.additionalRelationshipType}}
										<a
										ng-click="getComponent(component.terminology, item.toTerminologyId)"
										tooltip="{{item.terminology}} {{terminology.organizingClassType | lowercase}}">{{item.toTerminologyId}}</a>
										{{item.toName}}</li>
								</ul>

							</div>
						</div>
					</div>

					</tab> <tab heading="Metadata"> <!-- Metadata display -->
					<div class="container-fluid"">

						<div class="row">
                          <div class="col-md-12 col-xs-12" >
							<h3>Metadata for
								{{terminology.terminology}} {{terminology.terminologyVersion}}</h3>
							<ul>
								<li ng-repeat="item in metadata"
									ng-show="item.keyValuePair.length > 0"><b>{{item.name}}</b>
									<ul>
										<li ng-repeat="pair in item.keyValuePair">
											<span class="label label-info">{{pair.key}}</span>&nbsp;{{pair.value}}</li>
									</ul></li>
							</ul>
                          </div>
						</div>
					</div>
					</tab> </tabset>
				</div>
			</div>



			<div class="col-md-1 col-xs-0">
				<!-- blank column -->
			</div>
		</div>
    
        <!--  Show logout button at the bottom in XS mode -->
        <div id="mobileFooter" class="visible-xs hidden-md col-xs-12">
                    <button class="btn btn-sm btn-primary btn-structure"
              style="margin-top: 10px" ng-click="logout()"
              ng-show="authToken != null">Logout</button>
        </div>
	</div>

	<!-- Footer -->
	<nav style="background-color: #ffffff"
		class="hidden-xs navbar navbar-default navbar-fixed-bottom">
		<div class="container-fluid">
			<div class="navbar-header">
				<ul class="nav navbar-nav navbar-left">
					<li><p class="navbar-text">
							<a class="navbar-link" href="${deploy.footer.link}">Copyright
								@2015</a>
						</p></li>
					<li>
						<button class="btn btn-sm btn-primary btn-structure"
							style="margin-top: 10px" ng-click="logout()"
							ng-show="authToken != null">Logout</button>
					</li>
					<li>&nbsp;
						<p class="navbar-text">${project.version}</p>
					</li>
					<li>
						<div style="text-align: center; padding: 5px; margin: 0 0 0 0;"
							class="alert alert-danger" ng-show="glassPane < 0">
							The Glass Pane activity indicator may not be functioning
							correctly.<br>Please send a screenshot to an administrator.
							(GPC: {{glassPane}})
						</div>
					</li>
				</ul>
			</div>
			<div class="collapse navbar-collapse">
				<ul class="nav navbar-nav navbar-right">
					<li>
						<p class="navbar-text">
							Presented by <a href="http://www.westcoastinformatics.com">West
								Coast Informatics, LLC</a>
						</p>
					</li>
				</ul>
			</div>
		</div>
	</nav>

	<!-- Glass Pane -->
	<div ng-show="glassPane > 0" class="top-layer"></div>
</body>
</html>
