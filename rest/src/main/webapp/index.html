<html ng-app="tsApp">
<head>
<meta http-equiv="Content-Language" content="en" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>UMLS Terminology Server Demo</title>
<style type="text/css" media="all"></style>
<!-- Favicon -->
<link rel="icon" type="image/png" href="images/favicon.png" />

<!-- CSS  -->
<link rel="stylesheet"
	href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
<link href="ui/css/tsMobile.css" rel="stylesheet">

<!-- Angular core  -->
<script type="text/javascript" src="./ui/components/angular/angular.js"></script>

<!-- Angular/Boostrap UI Components -->
<script type="text/javascript"
	src="ui/components/angular-bootstrap/ui-bootstrap.js"></script>
<script type="text/javascript"
	src="ui/components/angular-bootstrap/ui-bootstrap-tpls-0.13.0.min.js"></script>

<!-- Terminology server Angular application -->
<script src="ui/js/app.js"></script>
</head>
<body ng-controller="tsIndexCtrl">
	<!--  Javascript detection -->
	<noscript>
		<style type="text/css">
.container-fluid {
	display: none;
}
</style>
		<div class="alert alert-danger">You must have Javascript enabled
			to use the Terminology Server Demo</div>
	</noscript>


	<!--  header -->
	<nav id="navBar"
		style="background: #00008A url('images/background.jpg');"
		class="navbar navbar-default navbar-fixed-top" role="navigation">
		<!-- Brand and toggle get grouped for better mobile display -->
		<div class="container-fluid">
			<div class="navbar-header">
				<table>
					<tr>
						<td><a href="http://www.westcoastinformatics.com"> <img
								class="hidden-xs" height="72px"
								style="background-color: white; padding: 5px; margin: 5px; border-radius: 5px;"
								src="images/logo65x72.jpg"> <img class="visible-xs"
								height="40px"
								style="background-color: white; padding: 3px; margin: 3px; border-radius: 3px;"
								src="images/logo36x40.jpg">
						</a></td>
						<td style="vertical-align: middle"><b style="color: white;">
								UMLS Terminology Server Demo and <a href="swagger.html"
								style="color: white; text-decoration: underline" target="_blank">API
									Documentation</a>
						</b></td>
					</tr>
				</table>
			</div>
		</div>
	</nav>

	<div class="container-fluid">
		<!-- Blank for header -->
		<div class="hidden-xs" style="height: 94px;">Makes room for
			content</div>
		<div class="visible-xs" style="height: 60px;">Makes room for
			content</div>

		<div class="row">
			<div class="col-md-1 col-xs-0">
				<!-- blank column -->
			</div>

			<!-- Content -->

			<div class="col-md-10 col-xs-12">
				<!-- Error Messages -->
				<div id="errorMsg" class="border-error alert-error"
					ng-show="error.length > 0">
					<h4 class="alert alert-danger alert-error">
						{{error}}
						<div style="display: inline; float: right; width: 3%;">
							<i class="glyphicon glyphicon-remove" ng-click="clearError()"></i>
						</div>
					</h4>
				</div>
				<!-- Done error messages -->

				<!-- Login form -->
				<div ng-show="authToken == null">
					<div>
						<div>
							<strong>Enter User and Password</strong><br>
							<form>
								<input class="loginField" id="userField" ng-model="userName"
									type="text" placeholder="Username" /><br> <input
									class="loginField" id="passwordField" type="password"
									placeholder="Password" ng-model="password" /><br>
								<button class="loginField" id="userLoginButton" type="submit"
									ng-click="login(userName, password)">Login</button>
								<p>
									<br /> <a
										href="https://uts.nlm.nih.gov/license.html#emailTemporaryPassword">Forgot
										Password?</a> <br /> <br />
								</p>
								<p class="introText">This demonstration app is loaded with
									data from two terminologies.</p>
								<ul>
									<li>UMLS, latest</li>
									<li>MSH, 2015_2014_09_08</li>
									<li>SNOMEDCT_US, 2014_09_01</li>
								</ul>
								<p class="introText">The mini version of SNOMED contains
									about 10K concepts. Due to the use of IP restricted content, we
									require users to authenticate with an NLM UTS account to ensure
									they have agreed to the UMLS License. We are a UMLS authorized
									content distributor.</p>
								<p class="introText">
									To obtain a UTS account, visit <a href="http://uts.nlm.nih.gov">http://uts.nlm.nih.gov</a>
								</p>
								<p class="introText">
									Disclaimer: this is not an official <a
										href="http://www.ihtsdo.org">IHTSDO</a> site.
								</p>
								<p class="introText">
									For complete documentation, see the <a
										href="http://wiki.terminology.tools/confluence/display/TS/TermServer+Home">SNOMED/RF2
										Terminology Server wiki</a>.
								</p>
								<p class="introText">
									For support, email:<a
										href="mailto:info@westcoastinformatics.com">info@westcoastinformatics.com</a>
							</form>
						</div>
					</div>
				</div>
				<!-- Done login form -->


				<!-- Content displayed after log in -->
				<div ng-show="authToken != null">


					<tabset> <tab heading="Concepts"> <!-- Search field is all columns -->
					<div>
						<table class="table">
							<tr>
								<td width="15%;">Select terminology</td>
								<td width="85%;"><select ng-model="terminology"
									ng-change="setTerminology(terminology)"
									ng-options="terminology as terminology.terminology for terminology in terminologies"></select></td>
							<tr>
								<td>Enter search terms</td>
								<td><form width="100%">



										<input type="text" ng-model="conceptQuery"
											placeholder="Enter search terms"
											typeahead="suggestion for suggestion in autocomplete(terminology, conceptQuery)"
											typeahead-loading="loadingSuggestions"
											typeahead-focus-first="false"
											typeahead-on-select="findConcepts(terminology, suggestion)"
											typeahead-editable="true">

										<button class="btn btn-small btn-primary" type="submit"
											ng-click="findConcepts(terminology, conceptQuery)">Search</button>
										<button class="btn btn-small btn-warning"
											ng-click="clearQuery()">Clear</button>

									</form></td>
							</tr>
						</table>
					</div>
					<!-- End search field --> <!-- Search Results -->
					<div class="row">

						<!-- search results field is 3 columns -->
						<div class="col-md-3 col-xs-4">
							<div class="alert alert-success"
								ng-show="searchResults.length > 0">{{searchResults.length}}
								Results (Click a row for details)</div>
							<div class="alert alert-danger"
								ng-show="searchResults && searchResults.length == 0">Search returned no
								results.</div>

							<pagination max-size="5" boundary-links="true"
								class="pagination-sm" previous-text="&lsaquo;"
								next-text="&rsaquo;" first-text="&laquo;" last-text="&raquo;"
								ng-show="searchResults.length > pageSize"
								total-items="searchResults.length" ng-model="searchResultsPage"
								ng-change="pagedSearchResults = getPagedArray(searchResults, searchResultsPage, false, null)"></pagination>

							<table class="table table-hover"
								ng-show="searchResults.length > 0">

								<tbody>
									<tr ng-repeat="searchResult in pagedSearchResults"
										ng-class="searchResult.rowClass"
										ng-click="getConcept(terminology, searchResult.terminologyId)">
										<td>{{searchResult.terminologyId}}</a></td>
										<td>{{searchResult.value}}</td>
								</tbody>
							</table>
						</div>


						<!-- Component display is 4 -->
						<div class="col-md-8 col-xs-12" ng-show="component != null">
							<div class="alert alert-info">
							<span ng-show="component.terminology != terminology.terminology">{{component.terminology}}</span>
							{{terminology.organizingClassType}}
								Report</div>
							<h3>ID# {{component.terminologyId}} {{component.name}}</h3>


							<button ng-show="hasBooleanFieldTrue(component, 'suppressible')"
								ng-click="toggleSuppressible()" class="btn btn-xs btn-primary">
								<span ng-show="showSuppressible == true">Hide
									Suppressible</span> <span ng-show="showSuppressible != true">Show
									Suppressible</span>
							</button>
							<button ng-show="hasBooleanFieldTrue(component, 'obsolete')"
								ng-click="toggleObsolete()" class="btn btn-xs btn-primary">
								<span ng-show="showObsolete == true">Hide Obsolete</span> <span
									ng-show="showObsolete != true">Show Obsolete</span>
							</button>




							<!--  Semantic types -->
							<div ng-show="component.semanticType.length > 0">
								<h4>Semantic Types ({{component.semanticType.length}})</h4>
								
								
								<pagination max-size="5" boundary-links="true"
									class="pagination-sm" previous-text="&lsaquo;"
									next-text="&rsaquo;" first-text="&laquo;" last-text="&raquo;"
									ng-show="component.semanticType.length > pageSize"
									total-items="component.semanticType.length" ng-model="semanticTypesPage"
									ng-change="pagedSemanticTypes = getPagedArray(component.semanticType, semanticTypesPage, true, null)"></pagination>
								
								<ul>
									<li class="cr-list" ng-repeat="item in component.semanticType"
										ng-show="showItem(item)"><span class="label label-info"
										ng-show="item.suppressible == true">Suppressible</span> <span
										class="label label-default" ng-show="item.obsolete == true">Obsolete</span>
										{{item.semanticType}}</li>
								</ul>

							</div>

							<!--  Definitions -->
							<div ng-show="type!='CODE' && component.definition.length > 0">
								<h4>
									Definitions ({{component.definition.length}})
									<h4>

										<pagination max-size="5" boundary-links="true"
											class="pagination-sm" previous-text="&lsaquo;"
											next-text="&rsaquo;" first-text="&laquo;" last-text="&raquo;"
											ng-show="component.description.length > pageSize"
											total-items="component.description.length" ng-model="descriptionsPage"
											ng-change="pagedDescriptions = getPagedArray(component.description, descriptionPage, true, null)"></pagination>

										<ul>
											<li class="cr-list" ng-repeat="item in component.definition"
												ng-show="showItem(item)"><span class="label label-info"
												ng-show="item.suppressible == true">Suppressible</span> <span
												class="label label-default" ng-show="item.obsolete == true">Obsolete</span>
												{{item}}</li>
										</ul>
							</div>

							<!-- Atoms -->
							<div ng-show="component.atom.length > 0">
								<h4>Atoms ({{component.atom.length}})</h4>

								<pagination max-size="5" boundary-links="true"
									class="pagination-sm" previous-text="&lsaquo;"
									next-text="&rsaquo;" first-text="&laquo;" last-text="&raquo;"
									ng-show="component.atom.length > pageSize"
									total-items="component.atom.length" ng-model="atomsPage"
									ng-change="pagedAtoms = getPagedArray(component.atom, atomsPage, true, null)"></pagination>


								<ul>
									<li class="cr-list" ng-repeat="item in pagedAtoms"
										ng-show="showItem(item)"><span class="label label-info"
										ng-show="item.suppressible == true">Suppressible</span> <span
										class="label label-default" ng-show="item.obsolete == true">Obsolete</span>
						
										<!--  Format:  name [terminology/termType/codeId] componentId descriptorId conceptTerminologyIds -->
										{{item.name}}
							
										<!-- 
											 Do not show terminology if same as component terminology
											 Do not show codeId if same as component terminology id or descriptorId
										 -->
										[
										<span ng-show="item.terminology != component.terminology">{{item.terminology}}/</span>
										{{item.termType}}
										<span ng-show="item.codeId != component.terminologyId && item.codeId != item.descriptorId">/{{item.codeId}}</span>
										]
										
										<!-- If same terminology, only show componentIds differing from component terminologyId -->
										<span ng-show="item.terminology == component.terminology && item.componentId != component.terminologyId">{{item.componentId}}</span>

										<!-- Show descriptorId  -->
										<span ng-show="item.descriptorId != component.terminologyId"> {{item.descriptorId}}</span></li>
			
										<!-- Show any referenced concepts in other terminologies -->
										<span ng-repeat="concept in conceptTerminologyIds">
											{{concept.key}}/{{concept.value}} -- {{concept}}
										</span>
								</ul>
							</div>

							<!--  Attributes -->
							<div ng-show="component.attribute.length > 0">
								<h4>Attributes ({{component.attribute.length}})</h4>
								
								
								<pagination max-size="5" boundary-links="true"
									class="pagination-sm" previous-text="&lsaquo;"
									next-text="&rsaquo;" first-text="&laquo;" last-text="&raquo;"
									ng-show="component.attribute.length > pageSize"
									total-items="component.attribute.length" ng-model="attributesPage"
									ng-change="pagedAttributes = getPagedArray(component.attribute, attributesPage, true, null)"></pagination>
								
								
								<ul>
									<li class="cr-list" ng-repeat="item in component.attribute"
										ng-show="showItem(item)"><span class="label label-info"
										ng-show="item.suppressible == true">Suppressible</span> <span
										class="label label-default" ng-show="item.obsolete == true">Obsolete</span>
										{{item.name}} = {{item.value}}
								</ul>
							</div>

							<!-- Relationships -->
							<div ng-show="component.relationship.length> 0">
								<h4>Relationships ({{component.relationship.length}})</h4>
								
								
								<pagination max-size="5" boundary-links="true"
									class="pagination-sm" previous-text="&lsaquo;"
									next-text="&rsaquo;" first-text="&laquo;" last-text="&raquo;"
									ng-show="component.relationship.length > pageSize"
									total-items="component.relationship.length" ng-model="relationshipsPage"
									ng-change="pagedRelationships = getPagedArray(component.relationship, relationshipsPage, true, null)"></pagination>
								
								<ul>
									<li class="cr-list" ng-repeat="item in component.relationship"
										ng-show="showItem(item)"><span class="label label-info"
										ng-show="item.suppressible == true">Suppressible</span> <span
										class="label label-default" ng-show="item.obsolete == true">Obsolete</span>
										{{item.relationshipType}} {{item.additionalRelationshipType}}
										<a ng-click="getConcept(terminology, item.toTerminologyId)">{{item.toTerminologyId}}</a>
										{{item.toName}}</li>
								</ul>

							</div>
						</div>
					</div>

					</tab> <tab heading="Metadata"> <!-- Metadata display -->
					<div class="container-fluid"">

						<div class="row">
							<h3>Metadata</h3>
							<ul>
								<li class="col-md-12 col-xs-12" ng-repeat="item in metadata"
									ng-show="item.keyValuePair.length > 0"><b>{{item.name}}</b>
									<ul>
										<li ng-repeat="pair in item.keyValuePair">
											{{pair.key}}&nbsp;{{pair.value}}</li>
									</ul></li>
							</ul>
						</div>
					</div>
					</tab> </tabset>
				</div>
			</div>



			<div class="col-md-1 col-xs-0">
				<!-- blank column -->
			</div>
		</div>
	</div>

	<!-- Footer -->
	<nav style="background-color: #ffffff"
		class="hidden-xs navbar navbar-default navbar-fixed-bottom">
		<div class="container-fluid">
			<div class="navbar-header">
				<ul class="nav navbar-nav navbar-left">
					<li><p class="navbar-text">
							<a class="navbar-link" href="${deploy.footer.link}">Copyright
								@2015</a>
						</p></li>
					<li>
						<button class="btn btn-sm btn-primary btn-structure"
							style="margin-top: 10px" ng-click="logout()"
							ng-show="authToken != null">Logout</button>
					</li>
					<li>&nbsp;
						<p class="navbar-text">${project.version}</p>
					</li>
					<li>
						<div style="text-align: center; padding: 5px; margin: 0 0 0 0;"
							class="alert alert-danger" ng-show="glassPane < 0">
							The Glass Pane activity indicator may not be functioning
							correctly.<br>Please send a screenshot to an administrator.
							(GPC: {{glassPane}})
						</div>
					</li>
				</ul>
			</div>
			<div class="collapse navbar-collapse">
				<ul class="nav navbar-nav navbar-right">
					<li>
						<p class="navbar-text">
							Presented by <a href="http://www.westcoastinformatics.com">West
								Coast Informatics, LLC</a>
						</p>
					</li>
				</ul>
			</div>
		</div>
	</nav>

	<!-- Glass Pane -->
	<div ng-show="glassPane > 0" class="top-layer"></div>
</body>
</html>
