<!-- Controlled by WorkflowCtrl (in workflowController.js)  -->
<div class="row">
  <!-- Workflow -->
  <div class="col-md-12 col-xs-12">
    <h5>
      <span>
        Project: <select ng-model="selected.project"
          ng-show="lists.projects.length > 1"
          ng-options="item.name for item in lists.projects"
          ng-change="setProject(selected.project);"></select>
        <span ng-show="lists.projects.length == 1">{{selected.project.name}}</span>
      </span>
      <span>
        &nbsp;&nbsp;Role: <select ng-model="selected.projectRole"
          ng-show="lists.projectRoles.length > 1"
          ng-options="projectRole for projectRole in lists.projectRoles"></select>
        <span ng-show="lists.projectRoles.length == 1">{{selected.projectRole}}</span>
      </span>
    </h5>
  </div>
  <div class="col-md-12 col-xs-12">
    <!-- Accordion -->
    <uib-accordion> <!-- A1 - Bins --> <uib-accordion-group
      is-open="true"> <uib-accordion-heading>
    <h5>
      <span uib-tooltip="Workflow Bins">Bins</span>
    </h5>
    </uib-accordion-heading>

    <div class="row m10">
      <div class="col-md-12 col-xs-12">
        <h5>
          <select ng-model="selected.config" ng-show="lists.configs.length > 1"
            ng-options="config.type for config in lists.configs"
            ng-change="setConfig(config);"></select>
          <span ng-show="lists.configs.length == 1">{{config.type}}</span>
          <i title="Regenerate bins" style="margin-left: 20px"
            ng-click="regenerateBins(); $event.stopPropagation()"
            class="noul glyphicon glyphicon-repeat"></i>
          <span ng-show="selected.projectRole == 'ADMINISTRATOR'"
            style="float: right;">
            <button ng-click="openAddBinModal()" title="Add new bin"
              class="btn btn-xs btn-primary">Add Bin</button>
          </span>
        </h5>
      </div>
      <div class="col-md-12 col-xs-12">
        <!-- NO paging control -->
        <table class="table table-hover" style="margin-top: 10px;"
          ng-show="lists.bins.length > 0">
          <thead class="pointer">
            <tr>
              <th class="col-md-1 col-xs-1">Rank</th>
              <th class="col-md-2 col-xs-2">Name</th>
              <th class="col-md-4 col-xs-4">Dates</th>
              <th class="col-md-1 col-xs-1">Cluster</th>
              <th class="col-md-1 col-xs-1">All</th>
              <th class="col-md-1 col-xs-1">Assigned</th>
              <th class="col-md-1 col-xs-1">Unassigned</th>
              <th class="col-md-1 col-xs-1">Actions</th>
            </tr>
          </thead>
          <tbody ng-repeat="bin in lists.bins">
            <tr ng-click="selectBin(bin, 'all');"
              ng-style="{'opacity' : bin.enabled == 0 ? 0.4 : 1}"
              ng-class="{selected: bin.id == selected.bin.id}">
              <td rowspan="4">{{bin.rank}}</td>
              <td rowspan="4">
                <i uib-tooltip="{{bin.description}}"
                  class="noul glyphicon glyphicon-question-sign"></i>
                &nbsp;{{bin.name}}</br>
                <span ng-show="selected.projectRole == 'ADMINISTRATOR'">
                  <input type="checkbox" title="Enable/Disable Bin"
                    ng-model="bin.enabled" ng-change="toggleEnable(bin)"></input>
                  <i ng-click="openEditBinModal(bin); $event.stopPropagation()"
                    ng-show="bin.enabled" title="Edit Bin"
                    class="noul glyphicon glyphicon-pencil"></i>
                  <i ng-click="openCloneBinModal(bin); $event.stopPropagation()"
                    ng-show="bin.enabled" title="Clone Bin"
                    class="noul glyphicon glyphicon-copy"></i>
                  <i
                    confirm="Are you sure you want to remove the bin definition?"
                    ng-click="removeBin(bin); $event.stopPropagation()"
                    ng-show="bin.enabled" title="Remove Bin"
                    class="noul glyphicon glyphicon-trash"></i>
                </span>
              </td>
              <td rowspan="4">
                Created: {{toDate(bin.creationTime)}} <br />Modified:
                {{toDate(bin.lastModified)}}
              </td>
            </tr>
            <tr ng-repeat="stats in bin.stats"
              ng-click="selectBin(bin, stats.clusterType);"
              ng-style="{'opacity' : bin.enabled == 0 ? 0.4 : 1}"
              ng-class="{selected: (stats.clusterType == selected.clusterType && bin.id == selected.bin.id) ||
                                      (selected.clusterType == 'all' && bin.id == selected.bin.id)}">
              <td>{{stats.clusterType}}</td>
              <td>{{stats.stats.all}}</td>
              <td>{{stats.stats.assigned}}</td>
              <td>{{stats.stats.unassigned}}</td>
              <td>
                <i
                  ng-show="stats.clusterType == 'all' && bin.stats.length > 1 && bin.enabled"
                  ng-click="setConfig(selected.config); $event.stopPropagation()"
                  title="Refresh counts"
                  class="noul glyphicon glyphicon-refresh"></i>
                <i ng-show="stats.clusterType != 'all' && bin.enabled"
                  ng-click="openCreateChecklistModal(bin, stats.clusterType); $event.stopPropagation()"
                  title="Add Checklist" class="noul glyphicon glyphicon-check"></i>
                &nbsp;
                <i ng-show="stats.clusterType != 'all' && bin.enabled"
                  ng-click="openCreateWorklistModal(bin, stats.clusterType, stats.stats.unassigned); $event.stopPropagation()"
                  title="Add Worklist" class="noul glyphicon glyphicon-list-alt"></i>
              </td>
            </tr>
          </tbody>
        </table>
        <span ng-show="lists.bins.length == 0" style="display: block;"
          class="alert alert-warning">No workflow Bins</span>
      </div>

      <hr ng-show="selected.bin">
      <!-- Bin Records Table -->
      <div ng-show="selected.bin" records-table selected="selected"
        lists="lists" user="user" paging="paging"></div>

    </div>
    </uib-accordion-group> <!-- A2 - Checklists --> <uib-accordion-group> <uib-accordion-heading>
    <h5>
      <span uib-tooltip="Workflow Checklists">Checklists</span>
    </h5>
    </uib-accordion-heading>
    <div worklists-table type="Checklist" selected="selected" lists="lists"
      user="user"></div>
    </uib-accordion-group> <!-- A3 - Worklists --> <uib-accordion-group> <uib-accordion-heading>
    <h5>
      <span uib-tooltip="Workflow Worklists">Worklists</span>
    </h5>
    </uib-accordion-heading>
    <div worklists-table type="Worklist" selected="selected" lists="lists"
      user="user"></div>
    </uib-accordion-group></uib-accordion>

  </div>
</div>